<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Function to visualise enrichment results using a tree-like...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xEnrichCtree"><tr><td>xEnrichCtree</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Function to visualise enrichment results using a tree-like circular plot</h2>

<h3>Description</h3>

<p><code>xEnrichCtree</code> is supposed to visualise enrichment results using a
tree-like circular plot.
</p>


<h3>Usage</h3>

<pre>
xEnrichCtree(
eTerm,
ig,
FDR.cutoff = NULL,
node.color = c("zscore", "adjp", "or", "nOverlap"),
colormap = "brewer.Reds",
zlim = NULL,
node.size = c("adjp", "zscore", "or", "nOverlap"),
slim = NULL,
node.size.range = c(0.5, 4.5),
group.gap = 0.08,
group.color = "lightblue",
group.size = 0.2,
group.label.size = 2,
group.label.color = "black",
legend.direction = c("auto", "horizontal", "vertical"),
leave.label.orientation = c("inwards", "outwards"),
...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>eTerm</code></td>
<td>
<p>an object of class &quot;eTerm&quot; or &quot;ls_eTerm&quot;. Alterntively, it
can be a data frame having all these columns
('name','adjp','or','zscore','nOverlap'; 'group' optionally)</p>
</td></tr>
<tr valign="top"><td><code>ig</code></td>
<td>
<p>an object of class &quot;igraph&quot; with node attribute 'name'. It
could be a 'phylo' object converted to. Note: the leave labels would be
the node attribute 'name' unless the node attribute 'label' is
explicitely provided</p>
</td></tr>
<tr valign="top"><td><code>FDR.cutoff</code></td>
<td>
<p>FDR cutoff used to show the significant terms only.
By default, it is set to NULL; useful when nodes sized by FDR</p>
</td></tr>
<tr valign="top"><td><code>node.color</code></td>
<td>
<p>which statistics will be used for node coloring. It
can be &quot;or&quot; for the odds ratio, &quot;adjp&quot; for adjusted p value (FDR) and
&quot;zscore&quot; for enrichment z-score</p>
</td></tr>
<tr valign="top"><td><code>colormap</code></td>
<td>
<p>short name for the colormap. It can be one of &quot;jet&quot;
(jet colormap), &quot;bwr&quot; (blue-white-red colormap), &quot;gbr&quot; (green-black-red
colormap), &quot;wyr&quot; (white-yellow-red colormap), &quot;br&quot; (black-red
colormap), &quot;yr&quot; (yellow-red colormap), &quot;wb&quot; (white-black colormap),
&quot;rainbow&quot; (rainbow colormap, that is,
red-yellow-green-cyan-blue-magenta), and &quot;ggplot2&quot; (emulating ggplot2
default color palette). Alternatively, any hyphen-separated HTML color
names, e.g. &quot;lightyellow-orange&quot; (by default), &quot;blue-black-yellow&quot;,
&quot;royalblue-white-sandybrown&quot;, &quot;darkgreen-white-darkviolet&quot;. A list of
standard color names can be found in
<a href="http://html-color-codes.info/color-names">http://html-color-codes.info/color-names</a></p>
</td></tr>
<tr valign="top"><td><code>zlim</code></td>
<td>
<p>the minimum and maximum values for which colors should be
plotted</p>
</td></tr>
<tr valign="top"><td><code>node.size</code></td>
<td>
<p>which statistics will be used for node size. It can be
&quot;or&quot; for the odds ratio, &quot;adjp&quot; for adjusted p value (FDR) and &quot;zscore&quot;
for enrichment z-score</p>
</td></tr>
<tr valign="top"><td><code>slim</code></td>
<td>
<p>the minimum and maximum values for which sizes should be
plotted</p>
</td></tr>
<tr valign="top"><td><code>node.size.range</code></td>
<td>
<p>the range of actual node size</p>
</td></tr>
<tr valign="top"><td><code>group.gap</code></td>
<td>
<p>the gap between group circles. Only works when
multiple groups provided</p>
</td></tr>
<tr valign="top"><td><code>group.color</code></td>
<td>
<p>the color of group circles. Only works when multiple
groups provided</p>
</td></tr>
<tr valign="top"><td><code>group.size</code></td>
<td>
<p>the line width of group circles. Only works when
multiple groups provided</p>
</td></tr>
<tr valign="top"><td><code>group.label.size</code></td>
<td>
<p>the size of group circle labelling. Always a
sequential integer located at the top middle. Only works when multiple
groups provided</p>
</td></tr>
<tr valign="top"><td><code>group.label.color</code></td>
<td>
<p>the color of group circle labelling. Only
works when multiple groups provided</p>
</td></tr>
<tr valign="top"><td><code>legend.direction</code></td>
<td>
<p>the legend guide direction. It can be
&quot;horizontal&quot; (useful for many groups with lengthy labelling),
&quot;vertical&quot; and &quot;auto&quot; (&quot;vertical&quot; when multiple groups provided;
otherwise &quot;horizontal&quot;)</p>
</td></tr>
<tr valign="top"><td><code>leave.label.orientation</code></td>
<td>
<p>the leave label orientation. It can be
&quot;outwards&quot; and &quot;inwards&quot;</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional graphic parameters used in xCtree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot2 object appended with 'ig', 'data' which should contain
columns 'x','y', 'leaf' (T/F), 'name' (the same as V(ig)$name), 'tipid'
(tip id), 'label' (if not given in ig, a 'name' varient), 'angle' and
'hjust' (assist in leave label orientation), and 'data_enrichment'
(enrichment results for tips)
</p>


<h3>Note</h3>

<p>none
</p>


<h3>See Also</h3>

<p><code>xCtree</code>
</p>


<h3>Examples</h3>

<pre>
## Not run: 
# Load the XGR package and specify the location of built-in data
library(XGR)
RData.location &lt;- "http://galahad.well.ox.ac.uk/bigdata"

# load the atlas of AA pathways
AA.template &lt;- xRDataLoader("AA.template",
RData.location=RData.location)
# consensus tree
ig &lt;- AA.template$consensus$ig

# enrichment analysis using AA pathways
input &lt;- xRDataLoader('Haploid_regulators_all',
RData.location=RData.location)
data &lt;- subset(input, Phenotype=="AKT")
genes &lt;- data$Gene[data$FDR&lt;0.05]
background &lt;- data$Gene
eTerm &lt;- xEnricherGenes(genes, background=background, ontology="AA",
min.overlap=5, test="fisher", RData.location=RData.location)

# circular visualisation of enriched AA pathways
gp &lt;- xEnrichCtree(eTerm, ig)

###############################
# advanced use: multiple groups
# enrichment analysis using AA pathways
Haploid &lt;- subset(input, FDR&lt;0.05)
ls_group &lt;- split(x=Haploid$Gene, f=Haploid$Phenotype)
background &lt;- unique(input$Gene)
ls_eTerm &lt;- xEnricherGenesAdv(ls_group, background=background,
ontologies="AA", test="fisher", min.overlap=5,
RData.location=RData.location)

# circular visualisation of enriched AA pathways
gp &lt;- xEnrichCtree(ls_eTerm, ig)

## End(Not run)
</pre>


</body></html>
